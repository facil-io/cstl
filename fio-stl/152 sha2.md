## SHA2

```c
#define FIO_SHA2
#include FIO_INCLUDE_FILE
```

By defining `FIO_SHA2`, the SHA-2 family of cryptographic hash functions (SHA-256 and SHA-512) will be defined and made available, along with their HMAC variants.

### Types

#### `fio_sha256_s`

```c
typedef struct {
  fio_u256 hash;
  fio_u512 cache;
  uint64_t total_len;
} fio_sha256_s;
```

Streaming SHA-256 type. Used with `fio_sha256_init`, `fio_sha256_consume`, and `fio_sha256_finalize` for incremental hashing.

#### `fio_sha512_s`

```c
typedef struct {
  fio_u512 hash;
  fio_u1024 cache;
  uint64_t total_len;
} fio_sha512_s;
```

Streaming SHA-512 type. Used with `fio_sha512_init`, `fio_sha512_consume`, and `fio_sha512_finalize` for incremental hashing.

### SHA-256 Functions

#### `fio_sha256`

```c
fio_u256 fio_sha256(const void *data, uint64_t len);
```

A simple, non-streaming implementation of the SHA-256 hashing algorithm.

**Parameters:**
- `data` - pointer to the data to hash
- `len` - length of the data in bytes

**Returns:** a `fio_u256` containing the 256-bit (32-byte) hash result.

#### `fio_sha256_init`

```c
fio_sha256_s fio_sha256_init(void);
```

Initializes a `fio_sha256_s` so the hash can consume streaming data.

**Returns:** an initialized `fio_sha256_s` structure.

#### `fio_sha256_consume`

```c
void fio_sha256_consume(fio_sha256_s *h, const void *data, uint64_t len);
```

Feeds data into the hash.

**Parameters:**
- `h` - pointer to the streaming hash state
- `data` - pointer to the data to hash
- `len` - length of the data in bytes

#### `fio_sha256_finalize`

```c
fio_u256 fio_sha256_finalize(fio_sha256_s *h);
```

Finalizes the streaming hash and returns the SHA-256 result.

**Parameters:**
- `h` - pointer to the streaming hash state

**Returns:** a `fio_u256` containing the 256-bit (32-byte) hash result.

**Note**: after finalization, the hash state should not be reused without re-initialization.

### SHA-512 Functions

#### `fio_sha512`

```c
fio_u512 fio_sha512(const void *data, uint64_t len);
```

A simple, non-streaming implementation of the SHA-512 hashing algorithm.

**Parameters:**
- `data` - pointer to the data to hash
- `len` - length of the data in bytes

**Returns:** a `fio_u512` containing the 512-bit (64-byte) hash result.

#### `fio_sha512_init`

```c
fio_sha512_s fio_sha512_init(void);
```

Initializes a `fio_sha512_s` so the hash can consume streaming data.

**Returns:** an initialized `fio_sha512_s` structure.

#### `fio_sha512_consume`

```c
void fio_sha512_consume(fio_sha512_s *h, const void *data, uint64_t len);
```

Feeds data into the hash.

**Parameters:**
- `h` - pointer to the streaming hash state
- `data` - pointer to the data to hash
- `len` - length of the data in bytes

#### `fio_sha512_finalize`

```c
fio_u512 fio_sha512_finalize(fio_sha512_s *h);
```

Finalizes the streaming hash and returns the SHA-512 result.

**Parameters:**
- `h` - pointer to the streaming hash state

**Returns:** a `fio_u512` containing the 512-bit (64-byte) hash result.

**Note**: after finalization, the hash state should not be reused without re-initialization.

### HMAC Functions

#### `fio_sha256_hmac`

```c
fio_u256 fio_sha256_hmac(const void *key,
                         uint64_t key_len,
                         const void *msg,
                         uint64_t msg_len);
```

Computes HMAC-SHA256, resulting in a 32-byte authentication code.

**Parameters:**
- `key` - pointer to the secret key
- `key_len` - length of the key in bytes
- `msg` - pointer to the message to authenticate
- `msg_len` - length of the message in bytes

**Returns:** a `fio_u256` containing the 256-bit (32-byte) HMAC result.

**Note**: keys longer than 64 bytes are hashed first (per HMAC specification).

#### `fio_sha512_hmac`

```c
fio_u512 fio_sha512_hmac(const void *key,
                         uint64_t key_len,
                         const void *msg,
                         uint64_t msg_len);
```

Computes HMAC-SHA512, resulting in a 64-byte authentication code.

**Parameters:**
- `key` - pointer to the secret key
- `key_len` - length of the key in bytes
- `msg` - pointer to the message to authenticate
- `msg_len` - length of the message in bytes

**Returns:** a `fio_u512` containing the 512-bit (64-byte) HMAC result.

**Note**: keys longer than 128 bytes are hashed first (per HMAC specification).

-------------------------------------------------------------------------------
