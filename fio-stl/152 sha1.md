## SHA1

```c
#define FIO_SHA1
#include FIO_INCLUDE_FILE
```

By defining the `FIO_SHA1`, the SHA1 (broken) Cryptographic Hash functions will be defined and made available.

**Warning(!) / Broken**: Do **NOT** use SHA1 for security concerns, it's broken and hopefully future cryptographic libraries won't include it in their packages... however, for some reason, some protocols require SHA1 (i.e., WebSockets).

### SHA1 Types

#### `fio_sha1_s`

```c
typedef union {
  uint32_t v[5];
  uint8_t digest[20];
} fio_sha1_s;
```

The data type containing the SHA1 digest (result).

**Members:**
- `v` - The 5 x 32-bit words of the SHA1 state
- `digest` - The 20-byte digest as raw bytes

### SHA1 Functions

#### `fio_sha1`

```c
fio_sha1_s fio_sha1(const void *data, uint64_t len);
```

A simple, non streaming, implementation of the SHA1 hashing algorithm.

**Parameters:**
- `data` - pointer to the data to hash
- `len` - length of the data in bytes

**Returns:** a `fio_sha1_s` containing the SHA1 digest.

#### `fio_sha1_hmac`

```c
fio_sha1_s fio_sha1_hmac(const void *key,
                         uint64_t key_len,
                         const void *msg,
                         uint64_t msg_len);
```

Computes HMAC-SHA1, resulting in a 20 byte authentication code.

**Parameters:**
- `key` - pointer to the secret key
- `key_len` - length of the key in bytes
- `msg` - pointer to the message to authenticate
- `msg_len` - length of the message in bytes

**Returns:** a `fio_sha1_s` containing the 20-byte HMAC authentication code.

**Note**: if `key_len` exceeds 64 bytes, the key is first hashed with SHA1.

#### `fio_sha1_len`

```c
size_t fio_sha1_len(void);
```

Returns the digest length of SHA1 in bytes (which is always 20).

#### `fio_sha1_digest`

```c
uint8_t *fio_sha1_digest(fio_sha1_s *s);
```

Returns a pointer to the digest of a SHA1 object. The digest is always 20 bytes long.

**Parameters:**
- `s` - pointer to a `fio_sha1_s` object

**Returns:** pointer to the 20-byte digest.

-------------------------------------------------------------------------------
